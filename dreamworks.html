<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>MRZYB Player Seri Universal</title>
<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">
<style>
body {
  margin:0;
  font-family:'Poppins', sans-serif;
  color:white;
  background:#0d0d0d;
}
.bg-fondo {
  display:flex;
  align-items:flex-end;
  padding:10px;
  padding-top:150px;
  position:relative;
  background:none;
  min-height:300px;
}
.bg-fondo::before {
  content:'';
  position:absolute;
  top:0;left:0;width:100%;height:100%;
  background-size:cover;
  background-position:center;
  z-index:-1;
  opacity:0.4;
  background-image:linear-gradient(to bottom, rgba(0,0,0,0.6), rgba(0,0,0,1)),
    url('https://i.pinimg.com/originals/e2/ae/e7/e2aee721f01bbfc7de534c56efd4da9e.gif');
}
#poster {
  width: 100%;
  max-width: 240px;
  border-radius: 12px;
  box-shadow: 0 0 15px rgba(255,255,255,0.8), 0 0 25px rgba(255,255,255,0.6);
}
#title {
  font-size: 22px;
  font-weight: 600;
}
.chip {
  font-size: 12px;
  font-weight: 600;
  color: #fff;
  background: linear-gradient(135deg, #00c853, #64dd17); /* default hijau untuk genre tidak terdaftar */
}
/* Warna-warni genre */
.chip[data-genre="Action"] {
  background: linear-gradient(135deg, #ff1744, #ff5252);
}
.chip[data-genre="Comedy"] {
  background: linear-gradient(135deg, #2979ff, #448aff);
}
.chip[data-genre="Romance"] {
  background: linear-gradient(135deg, #f50057, #ff4081);
}
.chip[data-genre="Fantasy"] {
  background: linear-gradient(135deg, #aa00ff, #d500f9);
}
.chip[data-genre="Horror"] {
  background: linear-gradient(135deg, #212121, #424242);
}
#rating {
  background: linear-gradient(135deg, #FFD700, #FFA500);
  color: #000;
  font-weight: 700;
}
#rating .star {
  color: #fff;
}
h6 {
  font-size: 16px;
  font-weight: 600;
}
.episode-btn {
  font-size: 12px;
}
@media (min-width: 600px) {
  #title { font-size: 28px; }
  .chip { font-size: 14px; }
  h6 { font-size: 18px; }
  .episode-btn { font-size: 14px; }
}
@media (min-width: 992px) {
  #title { font-size: 34px; }
  .chip { font-size: 16px; }
  h6 { font-size: 20px; }
  .episode-btn { font-size: 15px; }
}
.iframe-container {
  position:relative;width:100%;padding-top:56.25%;
  border-radius:12px;overflow:hidden;
  box-shadow:0 6px 18px rgba(0,0,0,0.7);
}
.responsive-iframe {
  position:absolute;top:0;left:0;width:100%;height:100%;border:0;
}
.episode-scroll-wrapper {
  overflow-x:auto;padding:10px 0;
  -webkit-overflow-scrolling:touch;
}
.episode-scroll {
  display:flex;gap:10px;
}
.episode-btn {
  flex-shrink:0;min-width:70px;text-align:center;
  border-radius:8px;
  transition:all 0.25s ease;
}
.episode-btn:hover {
  transform:translateY(-3px);
  box-shadow:0 4px 12px rgba(0,0,0,0.4);
}
.episode-btn.active-episode {
  background:linear-gradient(135deg, #ff4e50, #f9d423) !important;
}
.modal-content {
  position:relative;
  background:#1a1a1a;
  padding:10px;
  border-radius:14px;
  box-shadow:0 8px 20px rgba(0,0,0,0.8);
}
.modal-close {
  position:absolute;
  top:12px;right:12px;
  font-size:20px;
  background:rgba(0,0,0,0.6);
  border-radius:50%;
  width:34px;height:34px;
  display:flex;align-items:center;justify-content:center;
  cursor:pointer;
  transition:background 0.3s;
}
.modal-close:hover {
  background:rgba(255,255,255,0.15);
}
input, textarea {
  background:#111 !important;
  color:#fff !important;
  border-radius:8px !important;
  padding-left:10px !important;
}
button {
  background:linear-gradient(135deg, #2196f3, #21cbf3) !important;
  border-radius:8px;
  font-weight:600;
  transition:0.3s;
}
button:hover {
  opacity:0.9;
  transform:scale(1.02);
}
</style>
</head>
<body class="grey darken-4">

<!-- HEADER: Poster + Judul -->
<div class="row bg-fondo" id="bgFondo">
  <div class="col s3 m4 l2">
    <img id="poster" src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQAlGKrUpV0HWQsFq_WSbm9CU6OG3Pvz-92su1VM5dgq4587jCmQ9sD-mk&s=10" class="responsive-img" />
  </div>
  <div class="col s9 m8 l10">
    <h5 class="white-text mrzyb" id="title" style="margin-top:10px;">CHALKZONE</h5>
    <div class="movie-meta" style="margin-bottom:8px;">
      <div id="genre"></div>
      <div class="chip" id="rating"><span class="star">⭐</span> 10</div>
    </div>
    <h6>DAFTAR EPISODE</h6>
    <div class="episode-scroll-wrapper">
      <div class="episode-scroll" id="episode-list">
      </div>
    </div>
  </div>
</div>

<!-- PLAYER MODAL -->
<div id="modal2" class="modal grey darken-4">
  <div class="modal-content white-text">
    <span class="modal-close" onclick="closeModal()">✖</span>
    <div class="iframe-container">
      <iframe allowfullscreen class="responsive-iframe" id="video-player" sandbox="allow-same-origin allow-scripts" scrolling="no"></iframe>
    </div>
  </div>
</div>

<!-- INPUT GENERATE -->
<div class="container input-section" style="margin-top:20px;">
  <h6>Isi Data Film / Seri</h6>
  <input type="text" id="titleInput" placeholder="Judul Film">
  <input type="text" id="posterInput" placeholder="URL Poster">
  <input type="text" id="genreInput" placeholder="Genre (pisahkan dengan koma)">
  <input type="text" id="ratingInput" placeholder="Rating">
  <textarea id="episodesInput" placeholder="Masukkan link episode, satu per baris"></textarea>
  <button class="btn waves-effect waves-light" onclick="generateSeries()">Generate Link & Load</button>
  <div id="shareResult" style="margin-top:10px;"></div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
<script>
document.addEventListener('DOMContentLoaded', function() {
  const elems = document.querySelectorAll('.modal');
  M.Modal.init(elems, {dismissible: true});
});

function openModal(){
  const modal = M.Modal.getInstance(document.getElementById('modal2'));
  modal.open();
}

function closeModal(){
  document.getElementById('video-player').src='';
  const modal = M.Modal.getInstance(document.getElementById('modal2'));
  modal.close();
}

function loadSeries(data){
  if(data.poster) document.getElementById("poster").src=data.poster;
  if(data.title) document.getElementById("title").innerText=data.title;

  if(data.genre){
    const genreContainer = document.getElementById("genre");
    genreContainer.innerHTML = "";
    data.genre.split(",").forEach(g => {
      const chip = document.createElement("div");
      chip.className = "chip";
      chip.innerText = g.trim();
      chip.setAttribute("data-genre", g.trim());
      genreContainer.appendChild(chip);
    });
  }

  if(data.rating) document.getElementById("rating").innerHTML = '<span class="star">⭐</span> '+data.rating;

  const epContainer=document.getElementById("episode-list");
  epContainer.innerHTML="";
  if(data.episodes && data.episodes.length>0){
    data.episodes.forEach((ep,index)=>{
      const btn=document.createElement("a");
      btn.className="waves-effect blue btn episode-btn";
      btn.innerText=ep.name||("Ep "+(index+1));
      btn.href="#!";
      btn.dataset.video=ep.video;
      btn.onclick=function(){
        document.querySelectorAll('.episode-btn').forEach(b=>b.classList.remove('active-episode'));
        btn.classList.add('active-episode');
        document.getElementById('video-player').src=ep.video;
        openModal();
      };
      epContainer.appendChild(btn);
    });
  }
}

function generateSeries(){
  const title=document.getElementById("titleInput").value.trim();
  const poster=document.getElementById("posterInput").value.trim();
  const genre=document.getElementById("genreInput").value.trim();
  const rating=document.getElementById("ratingInput").value.trim();
  const epText=document.getElementById("episodesInput").value.trim();
  if(!epText){alert("Masukkan setidaknya satu link episode!"); return;}
  const epLines=epText.split("\n").map((url,i)=>({name:"Ep "+(i+1),video:url}));
  const data={title,poster,genre,rating,episodes:epLines};
  loadSeries(data);
  const encoded=btoa(JSON.stringify(data));
  const link=window.location.origin+window.location.pathname+"?data="+encoded;
  document.getElementById("shareResult").innerHTML=`<input style="width:100%;padding:8px;color:#0f0;background:#111;border:none;border-radius:5px;" value="${link}" readonly onclick="this.select()">`;
}

window.addEventListener("DOMContentLoaded",()=>{
  const params=new URLSearchParams(window.location.search);
  const encoded=params.get("data");
  if(encoded){
    try{
      const decoded=atob(encoded);
      const obj=JSON.parse(decoded);
      loadSeries(obj);
    }catch(e){console.error("Link tidak valid!");}
  }
});
</script>

</body>
</html>
